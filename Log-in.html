<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dogme | ä¸ªäººä¸­å¿ƒ ğŸ¾</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Quicksand', sans-serif; background-color: #fdfcf9; }
        .active-press:active { transform: scale(0.96); }
        .glass-card { background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.5); }
        .progress-bar-fill { transition: width 1.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        
        @keyframes subtlePulse {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }
        .float-tag-animation { animation: subtlePulse 3s ease-in-out infinite; }
    </style>
</head>
<body class="pb-20">
    <nav class="flex justify-between items-center px-8 py-6 sticky top-0 z-50 bg-white/70 backdrop-blur-xl border-b border-orange-50">
        <button onclick="location.href='index.html'" class="w-11 h-11 rounded-2xl bg-white shadow-sm flex items-center justify-center text-orange-500 active-press border border-orange-50">â®</button>
        <h1 class="text-xl font-black text-gray-900 tracking-tighter">My Dogme.</h1>
        <button onclick="handleLogout()" class="text-[10px] font-black text-gray-400 uppercase tracking-widest active-press">Logout</button>
    </nav>

    <main class="max-w-md mx-auto px-6 mt-10">
        <div class="glass-card rounded-[45px] p-10 text-center shadow-xl mb-8 relative overflow-hidden">
            <div class="relative inline-block mb-6">
                <img src="user.jpg" class="w-28 h-28 rounded-[35px] mx-auto border-4 border-white shadow-lg object-cover">
                <div id="user-level-tag" class="absolute -bottom-2 -right-2 bg-gray-900 text-white text-[10px] font-black px-3 py-1 rounded-full border-2 border-white">V1</div>
            </div>
            <h2 id="user-display-email" class="text-lg font-black text-gray-800 tracking-tight">è½½å…¥ä¸­...</h2>
            <p id="user-rank-title" class="text-[10px] font-black text-orange-500 uppercase tracking-widest mt-1">èŒæ–° Dogme</p>

            <div class="mt-8 px-4">
                <div class="flex justify-between items-center mb-2">
                    <span class="text-[10px] font-black text-gray-400 uppercase">Growth EXP</span>
                    <span id="exp-count-text" class="text-[10px] font-black text-gray-800">0 / 100</span>
                </div>
                <div class="w-full h-2 bg-gray-100 rounded-full overflow-hidden">
                    <div id="exp-bar-fill" class="progress-bar-fill h-full bg-orange-500" style="width: 0%"></div>
                </div>
            </div>
        </div>

        <div class="grid grid-cols-2 gap-4 mb-4">
            <div onclick="location.href='coupon.html'" class="bg-white p-6 rounded-[35px] border border-orange-50 shadow-sm active-press cursor-pointer">
                <span class="text-2xl block mb-2">ğŸŸï¸</span>
                <span class="font-black text-gray-800 block">æˆ‘çš„ä¼˜æƒ åˆ¸</span>
                <span id="coupon-status" class="text-[9px] font-bold text-gray-300 uppercase">å°šæœªé¢†å–</span>
            </div>

            <div id="shop-action-container">
                <div onclick="location.href='index.html'" class="bg-gray-900 p-6 rounded-[35px] shadow-lg active-press cursor-pointer text-center">
                    <span class="text-2xl block mb-2">ğŸ›’</span>
                    <span class="font-black text-white block">å»è´­ç‰©</span>
                    <span class="text-[9px] font-bold text-gray-500 uppercase">Shopping</span>
                </div>
            </div>
        </div>

        <div onclick="location.href='tracking.html'" class="float-tag-animation w-full bg-white p-6 rounded-[40px] border border-orange-100 shadow-xl shadow-orange-100/50 flex items-center justify-between active-press cursor-pointer mb-8">
            <div class="flex items-center gap-4">
                <div class="w-14 h-14 bg-orange-50 rounded-3xl flex items-center justify-center text-3xl">ğŸšš</div>
                <div class="text-left">
                    <span class="block font-black text-gray-800 text-lg">æŸ¥çœ‹ç‰©æµ</span>
                    <span class="block text-[10px] font-bold text-gray-400 uppercase tracking-widest">Track Packages</span>
                </div>
            </div>
            <div class="w-10 h-10 rounded-full bg-gray-50 flex items-center justify-center text-gray-300">â¯</div>
        </div>
    </main>

    <script>
        window.onload = () => {
            const isLogged = localStorage.getItem('dogme_user_logged');
            const email = localStorage.getItem('dogme_user_email');
            
            if (isLogged !== 'true' || !email) {
                window.location.replace('user.html');
                return;
            }

            document.getElementById('user-display-email').innerText = email;
            
            // 1. å¤„ç†è´­ä¹°å†å²é€»è¾‘
            const hasOrder = localStorage.getItem('dogme_has_order'); // æ¨¡æ‹Ÿè®¢å•æ ‡è®°
            const actionBtn = document.getElementById('shop-action-container');

            if (hasOrder === 'true') {
                // å¦‚æœæœ‰è´­ä¹°å†å²ï¼Œæ˜¾ç¤ºæ©™è‰²æŒ‰é’®
                actionBtn.innerHTML = `
                    <div onclick="location.href='orders.html'" class="bg-orange-500 p-6 rounded-[35px] shadow-lg shadow-orange-200 active-press cursor-pointer text-center">
                        <span class="text-2xl block mb-2">ğŸ“‹</span>
                        <span class="font-black text-white block">è´­ä¹°å†å²</span>
                        <span class="text-[9px] font-bold text-orange-200 uppercase">Order History</span>
                    </div>
                `;
            } else {
                // å¦‚æœæ²¡æœ‰ï¼Œä¿æŒâ€œå»è´­ç‰©â€æŒ‰é’®
                actionBtn.innerHTML = `
                    <div onclick="location.href='index.html'" class="bg-gray-900 p-6 rounded-[35px] shadow-lg active-press cursor-pointer text-center">
                        <span class="text-2xl block mb-2">ğŸ›’</span>
                        <span class="font-black text-white block">å»è´­ç‰©</span>
                        <span class="text-[9px] font-bold text-gray-500 uppercase">Go Shopping</span>
                    </div>
                `;
            }

            // 2. åŒæ­¥ç»éªŒå€¼å’Œä¼˜æƒ åˆ¸
            const currentExp = parseInt(localStorage.getItem('dogme_user_exp') || '0');
            setTimeout(() => {
                document.getElementById('exp-bar-fill').style.width = Math.min(currentExp, 100) + "%";
                document.getElementById('exp-count-text').innerText = `${currentExp} / 100`;
                if (currentExp >= 100) {
                    document.getElementById('user-level-tag').innerText = "V2";
                    document.getElementById('user-rank-title').innerText = "èµ„æ·± Dogme";
                }
            }, 300);

            if (localStorage.getItem('dogme_coupon_claimed') === 'true') {
                const status = document.getElementById('coupon-status');
                status.innerText = "8.0æŠ˜å·²æ¿€æ´»";
                status.classList.replace('text-gray-300', 'text-orange-500');
            }
        };

        function handleLogout() {
            if(confirm("ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼ŸğŸ¾")) {
                localStorage.clear();
                window.location.replace('index.html');
            }
        }
    </script>
</body>
</html>
