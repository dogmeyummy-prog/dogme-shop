<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dogme | æ”¯ä»˜ ğŸ¾</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Quicksand', sans-serif; }
        .active-press:active { transform: scale(0.96); }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        .pulse { animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
    </style>
</head>
<body class="bg-[#fdfcf9] min-h-screen">
    <nav class="flex justify-between items-center px-4 md:px-6 lg:px-12 py-4 md:py-6 sticky top-0 z-50 bg-white/60 backdrop-blur-xl border-b border-orange-50">
        <div class="flex items-center gap-2 md:gap-4">
            <button onclick="location.href='checkout.html'" class="w-10 h-10 md:w-11 md:h-11 rounded-2xl bg-white shadow-sm flex items-center justify-center text-orange-500 active-press border border-orange-50">â®</button>
            <h1 class="text-lg md:text-2xl font-black text-gray-800 tracking-tighter" data-t="pay_title">æ”¯ä»˜</h1>
        </div>
    </nav>

    <main class="max-w-2xl mx-auto px-4 md:px-6 mt-6 md:mt-10">
        <div class="bg-white rounded-[30px] md:rounded-[40px] p-6 md:p-10 shadow-lg border border-orange-50">
            <div class="text-center mb-8 md:mb-10">
                <div class="text-6xl md:text-8xl mb-4 md:mb-6 pulse">ğŸ’³</div>
                <h2 class="text-xl md:text-3xl font-black text-gray-800 mb-2 md:mb-3" data-t="pay_processing">æ­£åœ¨å¤„ç†æ”¯ä»˜</h2>
                <p id="amount-display" class="text-3xl md:text-5xl font-black text-orange-500">$0.00</p>
            </div>

            <div class="space-y-3 md:space-y-4 mb-6 md:mb-8">
                <div class="flex items-center justify-between p-4 md:p-5 bg-gray-50 rounded-2xl md:rounded-3xl">
                    <span class="font-bold text-sm md:text-base text-gray-600" data-t="pay_method">æ”¯ä»˜æ–¹å¼</span>
                    <span class="font-black text-sm md:text-base text-gray-800">Stripe</span>
                </div>
                <div class="flex items-center justify-between p-4 md:p-5 bg-gray-50 rounded-2xl md:rounded-3xl">
                    <span class="font-bold text-sm md:text-base text-gray-600" data-t="pay_status">æ”¯ä»˜çŠ¶æ€</span>
                    <span class="font-black text-sm md:text-base text-green-500" data-t="pay_success">æˆåŠŸ</span>
                </div>
            </div>

            <button onclick="completePurchase()" class="w-full py-4 md:py-5 bg-gray-900 text-white rounded-2xl md:rounded-3xl font-black text-base md:text-lg active-press hover:bg-orange-600 transition-all" data-t="pay_complete">
                å®Œæˆè´­ä¹°
            </button>
        </div>
    </main>

    <script src="i18n.js"></script>
    <script>
        const amount = localStorage.getItem('dogme_pending_total') || '$0.00';
        document.getElementById('amount-display').innerText = amount;

        function completePurchase() {
            const cart = JSON.parse(localStorage.getItem('dogme_cart')) || [];
            const orderHistory = JSON.parse(localStorage.getItem('dogme_order_history')) || [];
            
            const newOrder = {
                id: 'DGM' + Date.now(),
                date: new Date().toLocaleDateString('zh-CN'),
                timestamp: new Date().toISOString(),
                items: cart,
                total: parseFloat(amount.replace('$', '')),
                status: 'COMPLETED',
                statusColor: 'bg-green-500'
            };
            
            orderHistory.push(newOrder);
            localStorage.setItem('dogme_order_history', JSON.stringify(orderHistory));
            
            // Add experience points
            const currentExp = parseInt(localStorage.getItem('dogme_user_exp') || '0');
            const earnedExp = Math.floor(newOrder.total * 2);
            localStorage.setItem('dogme_user_exp', (currentExp + earnedExp).toString());
            
            // Clear cart
            localStorage.removeItem('dogme_cart');
            localStorage.removeItem('dogme_pending_total');
            
            alert(`è´­ä¹°æˆåŠŸï¼è·å¾— ${earnedExp} ç»éªŒå€¼ ğŸ¾`);
            location.href = 'user.html';
        }
    </script>

    <!-- Vercel Speed Insights -->
    <script>
        window.si = window.si || function () { (window.siq = window.siq || []).push(arguments); };
    </script>
    <script defer src="/_vercel/speed-insights/script.js"></script>
</body>
</html>
