<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dogme | ä¸ªäººä¸­å¿ƒ ğŸ¾</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Quicksand', sans-serif; background-color: #fdfcf9; }
        .active-press:active { transform: scale(0.96); }
        .glass-card { background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.5); }
        .progress-bar-fill { transition: width 1.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        @keyframes subtlePulse { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-5px); } }
        .float-tag-animation { animation: subtlePulse 3s ease-in-out infinite; }
    </style>
</head>
<body class="pb-20">
    <nav class="flex justify-between items-center px-6 md:px-8 py-4 md:py-6 sticky top-0 z-50 bg-white/70 backdrop-blur-xl border-b border-orange-50">
        <button onclick="location.href='index.html'" class="w-10 h-10 md:w-11 md:h-11 rounded-2xl bg-white shadow-sm flex items-center justify-center text-orange-500 active-press border border-orange-50">â®</button>
        <h1 class="text-lg md:text-xl font-black text-gray-900 tracking-tighter" data-t="user_title">ä¸ªäººä¸­å¿ƒ</h1>
        <div class="flex items-center gap-2">
            <div class="flex bg-gray-100 rounded-xl overflow-hidden">
                <button onclick="switchLanguage('zh')" id="lang-zh" class="px-2 py-1.5 text-[8px] md:text-[9px] font-black uppercase tracking-wider transition-colors">ä¸­æ–‡</button>
                <button onclick="switchLanguage('en')" id="lang-en" class="px-2 py-1.5 text-[8px] md:text-[9px] font-black uppercase tracking-wider transition-colors">EN</button>
                <button onclick="switchLanguage('fr')" id="lang-fr" class="px-2 py-1.5 text-[8px] md:text-[9px] font-black uppercase tracking-wider transition-colors">FR</button>
            </div>
            <button onclick="handleLogout()" class="text-[9px] md:text-[10px] font-black text-gray-400 uppercase tracking-widest active-press" data-t="user_logout">Logout</button>
        </div>
    </nav>

    <main class="max-w-md mx-auto px-4 md:px-6 mt-8 md:mt-10">
        <div class="glass-card rounded-[35px] md:rounded-[45px] p-8 md:p-10 text-center shadow-xl mb-6 md:mb-8 relative overflow-hidden">
            <div class="relative inline-block mb-4 md:mb-6">
                <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=dogme" class="w-24 h-24 md:w-28 md:h-28 rounded-[30px] md:rounded-[35px] mx-auto border-4 border-white shadow-lg object-cover">
                <div id="user-level-tag" class="absolute -bottom-2 -right-2 bg-gray-900 text-white text-[10px] font-black px-3 py-1 rounded-full border-2 border-white">V1</div>
            </div>
            <h2 id="user-display-email" class="text-base md:text-lg font-black text-gray-800 tracking-tight" data-t="checkout_loading">è½½å…¥ä¸­...</h2>
            
            <div class="mt-6 md:mt-8 px-2 md:px-4 text-left">
                <div class="flex justify-between items-center mb-2">
                    <span class="text-[10px] font-black text-gray-400 uppercase tracking-widest" data-t="user_growth_exp">Growth EXP</span>
                    <span id="exp-count-text" class="text-[10px] font-black text-gray-800">0 / 100</span>
                </div>
                <div class="w-full h-2 bg-gray-100 rounded-full overflow-hidden">
                    <div id="exp-bar-fill" class="progress-bar-fill h-full bg-orange-500" style="width: 0%"></div>
                </div>
            </div>
        </div>

        <div class="grid grid-cols-2 gap-3 md:gap-4 mb-3 md:mb-4">
            <div onclick="location.href='coupon.html'" class="bg-white p-5 md:p-6 rounded-[30px] md:rounded-[35px] border border-orange-50 shadow-sm active-press cursor-pointer">
                <span class="text-xl md:text-2xl block mb-2">ğŸŸï¸</span>
                <span class="font-black text-sm md:text-base text-gray-800 block" data-t="user_my_coupons">æˆ‘çš„ä¼˜æƒ åˆ¸</span>
                <span id="coupon-status" class="text-[9px] font-bold text-gray-300 uppercase" data-t="user_coupon_not_claimed">å°šæœªé¢†å–</span>
            </div>

            <div id="dynamic-order-btn">
                <div onclick="location.href='index.html'" class="bg-gray-900 p-5 md:p-6 rounded-[30px] md:rounded-[35px] shadow-lg active-press cursor-pointer text-center h-full">
                    <span class="text-xl md:text-2xl block mb-2">ğŸ›’</span>
                    <span class="font-black text-sm md:text-base text-white block" data-t="user_go_shopping">å»è´­ç‰©</span>
                    <span class="text-[9px] font-bold text-gray-500 uppercase" data-t="user_shopping_label">Shopping</span>
                </div>
            </div>
        </div>

        <div onclick="location.href='tracking.html'" class="float-tag-animation w-full bg-white p-5 md:p-6 rounded-[35px] md:rounded-[40px] border border-orange-100 shadow-xl shadow-orange-100/50 flex items-center justify-between active-press cursor-pointer mb-6 md:mb-8">
            <div class="flex items-center gap-3 md:gap-4">
                <div class="w-12 h-12 md:w-14 md:h-14 bg-orange-50 rounded-2xl md:rounded-3xl flex items-center justify-center text-2xl md:text-3xl">ğŸšš</div>
                <div class="text-left">
                    <span class="block font-black text-gray-800 text-base md:text-lg" data-t="user_track_packages">æŸ¥çœ‹ç‰©æµ</span>
                    <span class="block text-[10px] font-bold text-gray-400 uppercase tracking-widest" data-t="user_track_label">Track Packages</span>
                </div>
            </div>
            <div class="w-9 h-9 md:w-10 md:h-10 rounded-full bg-gray-50 flex items-center justify-center text-gray-300">â¯</div>
        </div>
    </main>

    <script src="i18n.js"></script>
    <script>
        function updateLanguageButtons() {
            const lang = localStorage.getItem('dogme_lang') || 'zh';
            ['zh', 'en', 'fr'].forEach(l => {
                const btn = document.getElementById(`lang-${l}`);
                if (l === lang) {
                    btn.classList.add('bg-gray-900', 'text-white');
                    btn.classList.remove('text-gray-400');
                } else {
                    btn.classList.remove('bg-gray-900', 'text-white');
                    btn.classList.add('text-gray-400');
                }
            });
        }

        window.onload = () => {
            const isLogged = localStorage.getItem('dogme_user_logged');
            const email = localStorage.getItem('dogme_user_email');
            
            if (isLogged !== 'true' || !email) {
                window.location.replace('login.html');
                return;
            }

            document.getElementById('user-display-email').innerText = email;
            
            const hasOrder = localStorage.getItem('dogme_has_order');
            const lang = localStorage.getItem('dogme_lang') || 'zh';
            const t = window.translations?.[lang] || window.translations?.['zh'];
            
            if (hasOrder === 'true') {
                document.getElementById('dynamic-order-btn').innerHTML = `
                    <div onclick="location.href='order-history.html'" class="bg-orange-500 p-5 md:p-6 rounded-[30px] md:rounded-[35px] shadow-lg shadow-orange-200 active-press cursor-pointer text-center h-full">
                        <span class="text-xl md:text-2xl block mb-2">ğŸ“‹</span>
                        <span class="font-black text-sm md:text-base text-white block" data-t="user_order_history">${t.user_order_history}</span>
                        <span class="text-[9px] font-bold text-orange-100 uppercase" data-t="user_orders_label">${t.user_orders_label}</span>
                    </div>
                `;
            }

            const currentExp = parseInt(localStorage.getItem('dogme_user_exp') || '0');
            setTimeout(() => {
                document.getElementById('exp-bar-fill').style.width = Math.min(currentExp, 100) + "%";
                document.getElementById('exp-count-text').innerText = `${currentExp} / 100`;
                if (currentExp >= 100) document.getElementById('user-level-tag').innerText = "V2";
            }, 300);

            if (localStorage.getItem('dogme_coupon_claimed') === 'true') {
                const status = document.getElementById('coupon-status');
                status.setAttribute('data-t', 'user_coupon_activated');
                status.classList.replace('text-gray-300', 'text-orange-500');
                status.innerText = t.user_coupon_activated;
            }
            
            updateLanguageButtons();
        };

        function handleLogout() {
            const lang = localStorage.getItem('dogme_lang') || 'zh';
            const t = window.translations?.[lang] || window.translations?.['zh'];
            if(confirm(t.user_logout_confirm)) {
                localStorage.clear();
                window.location.replace('index.html');
            }
        }

        window.translations = translations;
    </script>

    <!-- Vercel Speed Insights -->
    <script>
        window.si = window.si || function () { (window.siq = window.siq || []).push(arguments); };
    </script>
    <script defer src="/_vercel/speed-insights/script.js"></script>
</body>
</html>
