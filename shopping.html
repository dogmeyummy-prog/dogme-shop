<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dogme Shop | å…¨çƒè´§æŸœ ğŸ¾</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Quicksand', sans-serif; background-color: #fdfcf9; overflow-x: hidden; }
        .active-press:active { transform: scale(0.95); }
        .product-card {
            background: white; border-radius: 35px; padding: 24px;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: 1px solid rgba(0,0,0,0.02);
        }
        .product-card:hover { transform: translateY(-10px); box-shadow: 0 20px 40px rgba(0,0,0,0.05); }
        .nav-icon-btn { width: 44px; height: 44px; border-radius: 12px; object-fit: cover; cursor: pointer; transition: all 0.3s ease; border: 1px solid #f1f1f1; }
        .cart-particle { position: fixed; z-index: 1000; pointer-events: none; transition: all 0.8s cubic-bezier(0.19, 1, 0.22, 1); }
    </style>
</head>
<body class="p-6 md:p-12">

    <nav class="max-w-7xl mx-auto flex justify-between items-center mb-12">
        <div class="flex items-center gap-6">
            <h1 class="text-3xl font-black tracking-tighter cursor-pointer" onclick="location.href='index.html'">Dogme.</h1>
            <div class="flex bg-gray-100 rounded-full p-1 shadow-inner text-[10px] font-black">
                <button onclick="switchLanguage('zh')" class="px-2 py-1 rounded-full hover:bg-white transition-all">CN</button>
                <button onclick="switchLanguage('en')" class="px-2 py-1 rounded-full hover:bg-white transition-all">EN</button>
                <button onclick="switchLanguage('fr')" class="px-2 py-1 rounded-full hover:bg-white transition-all">FR</button>
            </div>
        </div>
        
        <div class="flex items-center gap-4">
            <div class="hidden md:flex flex-col items-end mr-4">
                <span id="rank-name-display" class="text-[10px] font-black uppercase tracking-widest text-gray-400">Loading...</span>
                <div class="w-24 h-1.5 bg-gray-100 rounded-full mt-1 overflow-hidden">
                    <div id="exp-fill" class="h-full bg-orange-500 transition-all duration-1000" style="width: 0%"></div>
                </div>
            </div>
            <div onclick="location.href='checkout.html'" class="relative active-press" id="cart-target">
                <img src="shopping-car.jpg" class="nav-icon-btn shadow-sm">
                <div id="cart-count-badge" class="absolute -top-1 -right-1 bg-orange-500 text-white text-[10px] font-bold w-5 h-5 rounded-full flex items-center justify-center border-2 border-white">0</div>
            </div>
            <img src="user.jpg" onclick="location.href='user.html'" class="nav-icon-btn hover:ring-2 ring-orange-400">
        </div>
    </nav>

    <header class="max-w-7xl mx-auto mb-12">
        <h2 data-t="shop_title" class="text-5xl font-black text-gray-900 mb-4">Global Snacks.</h2>
        <p data-t="shop_subtitle" class="text-gray-400 font-bold">ç²¾é€‰å…¨çƒé›¶é£Ÿï¼Œç›´é‚®åŠ æ‹¿å¤§å…¨å¢ƒã€‚ğŸ¾</p>
    </header>

    <main id="product-grid" class="max-w-7xl mx-auto grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8">
        </main>

    <script src="i18n.js"></script>
    <script>
        const products = [
            { id: 1, name: "Calbee Honey Butter", price: 4.50, emoji: "ğŸ¯", img: "snack1.jpg" },
            { id: 2, name: "Lay's Truffle", price: 3.99, emoji: "ğŸ„", img: "snack2.jpg" },
            { id: 3, name: "Pocky Sakura", price: 2.50, emoji: "ğŸŒ¸", img: "snack3.jpg" },
            { id: 4, name: "White Lover", price: 18.00, emoji: "â„ï¸", img: "snack4.jpg" }
        ];

        // æ¸²æŸ“å‡½æ•°ï¼šå¢åŠ äº†å¯¹ i18n æŒ‰é’®æ–‡æ¡ˆçš„æ”¯æŒ
        function render() {
            const grid = document.getElementById('product-grid');
            const lang = localStorage.getItem('dogme_lang') || 'zh';
            const btnText = translations[lang]['btn_add'] || 'ADD TO CART +';

            grid.innerHTML = products.map(p => `
                <div class="product-card group">
                    <div class="relative h-64 mb-6 rounded-[25px] overflow-hidden bg-gray-50">
                        <img src="${p.img}" class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-500" onerror="this.src='logo.jpg'">
                        <div class="absolute top-4 left-4 bg-white/90 backdrop-blur px-3 py-1 rounded-full shadow-sm">
                            <span class="text-lg">${p.emoji}</span>
                        </div>
                    </div>
                    <h3 class="font-black text-gray-900 text-xl mb-1">${p.name}</h3>
                    <p class="text-orange-500 font-black mb-6">$${p.price.toFixed(2)} <span class="text-[10px] text-gray-300 ml-1">CAD</span></p>
                    <button onclick="addToCart(event, '${p.name}', ${p.price}, '${p.emoji}')" 
                            class="w-full py-4 bg-gray-50 text-gray-900 rounded-2xl font-black text-sm hover:bg-gray-900 hover:text-white transition-all active-press">
                        ${btnText}
                    </button>
                </div>
            `).join('');
            syncStatus();
        }

        // åŠ å…¥è´­ç‰©è½¦å¹¶è§¦å‘åŠ¨ç”»
        function addToCart(event, name, price, emoji) {
            const btn = event.currentTarget;
            const startRect = btn.getBoundingClientRect();
            const targetRect = document.getElementById('cart-target').getBoundingClientRect();
            
            const particle = document.createElement('div');
            particle.className = 'cart-particle text-2xl';
            particle.innerHTML = emoji;
            particle.style.left = startRect.left + (startRect.width/2) + 'px';
            particle.style.top = startRect.top + 'px';
            document.body.appendChild(particle);

            requestAnimationFrame(() => {
                const diffX = targetRect.left - startRect.left;
                const diffY = targetRect.top - startRect.top;
                particle.style.transform = `translate(${diffX}px, ${diffY}px) scale(0.5) rotate(360deg)`;
                particle.style.opacity = '0';
            });
            setTimeout(() => { particle.remove(); syncStatus(); }, 800);

            let cart = JSON.parse(localStorage.getItem('dogme_cart') || '[]');
            cart.push({ id: Date.now(), name, price, emoji });
            localStorage.setItem('dogme_cart', JSON.stringify(cart));
            localStorage.setItem('dogme_user_exp', parseFloat(localStorage.getItem('dogme_user_exp') || '0') + 2);
        }

        function syncStatus() {
            const cart = JSON.parse(localStorage.getItem('dogme_cart') || '[]');
            document.getElementById('cart-count-badge').innerText = cart.length;

            let currentExp = parseInt(localStorage.getItem('dogme_user_exp') || '0');
            let level = Math.floor(currentExp / 100) + 1;
            const lang = localStorage.getItem('dogme_lang') || 'zh';
            const levelLabel = { 'zh': 'ç­‰çº§', 'en': 'Level', 'fr': 'Niveau' }[lang];
            
            document.getElementById('rank-name-display').innerText = `${levelLabel} V${level > 9 ? 9 : level}`;
            document.getElementById('exp-fill').style.width = (currentExp % 100) + '%';
        }

        window.onload = render;
    </script>
</body>
</html>
